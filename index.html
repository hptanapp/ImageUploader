<!DOCTYPE html>
<html>

<script src="https://www.gstatic.com/firebasejs/4.8.1/firebase.js"></script>
<script type="text/javascript" src="js/connectFirebaseAPI.js"></script>
<script type="text/javascript" src="js/imageHandler.js"></script>
<script type="text/javascript" src="js/submitForms.js"></script>

<script type="text/javascript">

  var list_subkey = ["Submitter_Name",
                    "Submitter_Email",
                    "Submitter_Date",
                    "Submitter_Type"
                    ]
  var list_cardkey = ["Name",
                      "CompanyName",
                      "ServiceField",
                      "Position",
                      "Contact",
                      "Address",
                      "WorkingHour",
                      "CoverageArea",
                      "AdditionalTags"
                      ]

  var list_db = [ "Submitter_Name",
                  "Submitter_Email",
                  "Submitter_Date",
                  "Submitter_Type",
                  "Name",
                  "CompanyName",
                  "ServiceField",
                  "Position",
                  "Contact",
                  "Address",
                  "WorkingHour",
                  "CoverageArea",
                  "AdditionalTags"
                ]

  //Firebase Database Handling
  function writeUserData(userId, name, email) {
    var dbtype = "userbase";

    var Submitter_Name;
    var Submitter_Email;
    var Submitter_Date;
    var Submitter_Type;

    var Name;
    var CompanyName;
    var ServiceField;
    var Position;
    var Contact;
    var Address;
    var WorkingHour;
    var CoverageArea;
    var AdditionalTags;

    // Submitter_Name
    var intextbox = document.getElementById("Submitter_Name");
    if (intextbox.value != ""){
      Submitter_Name = intextbox.value;
    } else {
      Submitter_Name = "guest";
    }

    // Submitter_Email
    var intextbox = document.getElementById("Submitter_Email");
    if (intextbox.value != ""){
      Submitter_Email = intextbox.value;
    } else {
      Submitter_Email = "-";
    }

    // Submitter_Date
    var d = new Date();
    Submitter_Date = ISODateString(d);

    // Submitter_Email
    var intextbox = document.getElementById("Submitter_Type");
    if (intextbox.value != ""){
      Submitter_Type = intextbox.value;
    } else {
      Submitter_Type = "public";
    }

    // Name
    var intextbox = document.getElementById("Name");
    if (intextbox.value != ""){
      Name = intextbox.value;
    } else {
      Name = "-";
    }

    // CompanyName
    var intextbox = document.getElementById("CompanyName");
    if (intextbox.value != ""){
      CompanyName = intextbox.value;
    } else {
      CompanyName = "-";
    }

    // ServiceField
    var intextbox = document.getElementById("ServiceField");
    if (intextbox.value != ""){
      ServiceField = intextbox.value;
    } else {
      ServiceField = "-";
    }

    // Position
    var intextbox = document.getElementById("Position");
    if (intextbox.value != ""){
      Position = intextbox.value;
    } else {
      Position = "-";
    }

    // Contact
    var intextbox = document.getElementById("Contact");
    if (intextbox.value != ""){
      Contact = intextbox.value;
    } else {
      Contact = "-";
    }

    // Address
    var intextbox = document.getElementById("Address");
    if (intextbox.value != ""){
      Address = intextbox.value;
    } else {
      Address = "-";
    }

    // WorkingHour
    var intextbox = document.getElementById("WorkingHour");
    if (intextbox.value != ""){
      WorkingHour = intextbox.value;
    } else {
      WorkingHour = "-";
    }

    // CoverageArea
    var intextbox = document.getElementById("CoverageArea");
    if (intextbox.value != ""){
      CoverageArea = intextbox.value;
    } else {
      CoverageArea = "-";
    }

    // AdditionalTags
    var intextbox = document.getElementById("AdditionalTags");
    if (intextbox.value != ""){
      AdditionalTags = intextbox.value;
    } else {
      AdditionalTags = "-";
    }

    alert("Submitter_Name = " + Submitter_Name);
    alert("Submitter_Email = " + Submitter_Email);
    alert("Submitter_Date = " + Submitter_Date);
    alert("Submitter_Type = " + Submitter_Type);

    alert("Name = " + Name);
    alert("CompanyName = " + CompanyName);
    alert("ServiceField = " + ServiceField);
    alert("Position = " + Position);

    alert("Contact = " + Contact);
    alert("Address = " + Address);
    alert("WorkingHour = " + WorkingHour);
    alert("CoverageArea = " + CoverageArea);

    // firebase.database().ref('users/' + userId).set({
    //   type: "dbtype",
    //   username: name,
    //   email: email
    // });
  }

  // UTC time
  function ISODateString(d) {
    function pad(n) {return n<10 ? '0'+n : n}
    return d.getUTCFullYear()+'-'
         + pad(d.getUTCMonth()+1)+'-'
         + pad(d.getUTCDate())+'T'
         + pad(d.getUTCHours())+':'
         + pad(d.getUTCMinutes())+':'
         + pad(d.getUTCSeconds())+'Z'
}

</script>

<head>
	<title>This is Title</title>
</head>
<body>
	<h1>Welcome to My App</h1>
</body>
  <h1>Upload Name Card</h1>
  <div>
    <label for="profile_pic">Choose file to upload</label>
    <input type="file" id="profile_pic" name="profile_pic"
          accept=".jpg, .jpeg, .png">
  </div>
    
    <h2>Submitter Information:</h2>
    <button class="cls_button_pre" id="btn_prepareUploadSubForm" onclick="prepareUploadSubForm()">Prepare Upload Submitter Information</button>
    <div id="SubmitterInfoPlaceholder"></div>
    
    <h2>Card Information:</h2>
    <button class="cls_button_pre" id="btn_prepareUploadCardForm" onclick="prepareUploadCardForm()">Prepare Card Information</button>
    <div id="CardInfoPlaceholder"></div>

    <br/>
    <input type="checkbox" name="vehicle" value="Car">I hereby giving information consent to this web application for items and information I have submitted.
    <br/>
    <br/>
  <div>
    <!-- <button class="cls_button1" onclick="UploadFile()">Upload</button> -->
    <button class="cls_button1" onclick="writeUserData()">Upload</button>
  </div>

  <br/>
  <h1>Search For Name Card</h1>
  <div>
    <button class="cls_button2" onclick="showimage()">Search</button>
  </div>
  <div>
    <input type="text" id="filter" name="filter">
  </div>
  <div>
    <img id="showimage" src="" height="125px" width="200px" style="visibility: hidden;" />
  </div>
</html>